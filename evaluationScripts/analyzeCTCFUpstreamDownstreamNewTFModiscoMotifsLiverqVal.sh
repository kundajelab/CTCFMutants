# Get the motif hits in the Myers Lab 14.5 day liver data
python /srv/scratch/imk1/TFBindingPredictionProject/src/RegElEvoCode/convertFIMOToMotifHitBed.py --nameCol 0 --fimoFileName /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W.FIMOResultsNewTFModiscoMotifs/fimo.txt --qValCutoff 0.05 --outputFileName /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W.FIMOResultsNewTFModiscoMotifs/fimoqVal.bed

# Get regions with groups of motifs that have the same sub-motif
awk 'BEGIN{OFS="\t"} $4=="Core"' /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W.FIMOResultsNewTFModiscoMotifs/fimoqVal.bed | intersectBed -wa -u -a /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W.narrowPeak.gz -b stdin > /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_coreMotifNewTFModiscoqVal.bed
awk 'BEGIN{OFS="\t"} $4=="Upstream"' /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W.FIMOResultsNewTFModiscoMotifs/fimoqVal.bed | intersectBed -wa -u -a /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W.narrowPeak.gz -b stdin > /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_upstreamMotifNewTFModiscoqVal.bed
awk 'BEGIN{OFS="\t"} $4=="Downstream"' /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W.FIMOResultsNewTFModiscoMotifs/fimoqVal.bed | intersectBed -wa -u -a /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W.narrowPeak.gz -b stdin > /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_downstreamMotifNewTFModiscoqVal.bed # Empty file
awk 'BEGIN{OFS="\t"} $4=="UpstreamCore"' /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W.FIMOResultsNewTFModiscoMotifs/fimoqVal.bed | intersectBed -wa -u -a /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W.narrowPeak.gz -b stdin > /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_upstreamCoreMotifNewTFModiscoqVal.bed
awk 'BEGIN{OFS="\t"} $4=="CoreDownstream"' /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W.FIMOResultsNewTFModiscoMotifs/fimoqVal.bed | intersectBed -wa -u -a /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W.narrowPeak.gz -b stdin > /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_coreDownstreamMotifNewTFModiscoqVal.bed
awk 'BEGIN{OFS="\t"} $4=="UpstreamCoreDownstream"' /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W.FIMOResultsNewTFModiscoMotifs/fimoqVal.bed | intersectBed -wa -u -a /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W.narrowPeak.gz -b stdin > /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_upstreamCoreDownstreamMotifNewTFModiscoqVal.bed
subtractBed -A -a /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_coreMotifNewTFModiscoqVal.bed -b /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_upstreamMotifNewTFModiscoqVal.bed | subtractBed -A -a stdin -b /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_upstreamCoreMotifNewTFModiscoqVal.bed | subtractBed -A -a stdin -b /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_coreDownstreamMotifNewTFModiscoqVal.bed | subtractBed -A -a stdin -b /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_upstreamCoreDownstreamMotifNewTFModiscoqVal.bed | sort -u -k1,1 -k2,2n -k3,3n -k10,10n > /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_coreOnlyMotifNewTFModiscoqVal.bed
cat /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_upstreamMotifNewTFModiscoqVal.bed /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_upstreamCoreMotifNewTFModiscoqVal.bed | subtractBed -A -a stdin -b /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_coreDownstreamMotifNewTFModiscoqVal.bed | subtractBed -A -a stdin -b /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_upstreamCoreDownstreamMotifNewTFModiscoqVal.bed | sort -u -k1,1 -k2,2n -k3,3n -k10,10n > /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_upstreamNoDownstreamMotifNewTFModiscoqVal.bed
subtractBed -A -a /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_coreDownstreamMotifNewTFModiscoqVal.bed -b /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_upstreamMotifNewTFModiscoqVal.bed | subtractBed -A -a stdin -b /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_upstreamCoreMotifNewTFModiscoqVal.bed | subtractBed -A -a stdin -b /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_upstreamCoreDownstreamMotifNewTFModiscoqVal.bed | sort -u -k1,1 -k2,2n -k3,3n -k10,10n > /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_downstreamNoUpstreamMotifNewTFModiscoqVal.bed
cat /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_upstreamCoreMotifNewTFModiscoqVal.bed /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_coreDownstreamMotifNewTFModiscoqVal.bed /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_upstreamCoreDownstreamMotifNewTFModiscoqVal.bed | sort -u -k1,1 -k2,2n -k3,3n -k10,10n > /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_corePlusMotifNewTFModiscoqVal.bed
subtractBed -A -a /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_coreMotifNewTFModiscoqVal.bed -b /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_upstreamMotifNewTFModiscoqVal.bed | subtractBed -A -a stdin -b /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_upstreamCoreMotifNewTFModiscoqVal.bed | subtractBed -A -a stdin -b /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_upstreamCoreDownstreamMotifNewTFModiscoqVal.bed | sort -u -k1,1 -k2,2n -k3,3n -k10,10n > /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_coreNoUpstreamMotifNewTFModiscoqVal.bed
subtractBed -A -a /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_coreMotifNewTFModiscoqVal.bed -b /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_coreDownstreamMotifNewTFModiscoqVal.bed | subtractBed -A -a stdin -b /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_upstreamCoreDownstreamMotifNewTFModiscoqVal.bed | sort -u -k1,1 -k2,2n -k3,3n -k10,10n > /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Liver_Ren_8W_coreNoDownstreamMotifNewTFModiscoqVal.bed
