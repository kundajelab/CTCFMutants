# Get the motif hits in the Myers Lab liver data from at 14.5-day-old mouse
fimo --bgfile /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.background --max-stored-scores 50000000 --o /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.FIMOResultsNewTFModiscoMotifsAllHits --thresh 1 /srv/scratch/imk1/TFBindingPredictionProject/MouseMutantData/newTFModiscoMotifCombinations.meme /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.fa
python /srv/scratch/imk1/TFBindingPredictionProject/src/RegElEvoCode/convertFIMOToMotifHitBed.py --nameCol 0 --fimoFileName /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.FIMOResultsNewTFModiscoMotifsAllHits/fimo.txt --qValCutoff 1.01 --scoreCol 8 --outputFileName /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.FIMOResultsNewTFModiscoMotifsAllHits/fimoqVal.bed

# Get regions with groups of motifs that have the same sub-motif
awk 'BEGIN{OFS="\t"} $4=="Core"' /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.FIMOResultsNewTFModiscoMotifsAllHits/fimoqVal.bed | intersectBed -wa -u -a /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.narrowPeak.gz -b stdin > /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W_coreMotifNewTFModiscoAllHits.bed
awk 'BEGIN{OFS="\t"} $4=="Upstream"' /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.FIMOResultsNewTFModiscoMotifsAllHits/fimoqVal.bed | intersectBed -wa -u -a /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.narrowPeak.gz -b stdin > /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W_upstreamMotifNewTFModiscoAllHits.bed
awk 'BEGIN{OFS="\t"} $4=="Downstream"' /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.FIMOResultsNewTFModiscoMotifsAllHits/fimoqVal.bed | intersectBed -wa -u -a /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.narrowPeak.gz -b stdin > /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W_downstreamMotifNewTFModiscoAllHits.bed
awk 'BEGIN{OFS="\t"} $4=="UpstreamCore"' /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.FIMOResultsNewTFModiscoMotifsAllHits/fimoqVal.bed | intersectBed -wa -u -a /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.narrowPeak.gz -b stdin > /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W_upstreamCoreMotifNewTFModiscoAllHits.bed
awk 'BEGIN{OFS="\t"} $4=="CoreDownstream"' /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.FIMOResultsNewTFModiscoMotifsAllHits/fimoqVal.bed | intersectBed -wa -u -a /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.narrowPeak.gz -b stdin > /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W_coreDownstreamMotifNewTFModiscoAllHits.bed
awk 'BEGIN{OFS="\t"} $4=="UpstreamCoreDownstream"' /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.FIMOResultsNewTFModiscoMotifsAllHits/fimoqVal.bed | intersectBed -wa -u -a /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.narrowPeak.gz -b stdin > /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W_upstreamCoreDownstreamMotifNewTFModiscoAllHits.bed

# Compare the occurrences of the different types of motifs to the peak height
awk 'BEGIN{OFS="\t"} $4=="Core"' /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.FIMOResultsNewTFModiscoMotifsAllHits/fimoqVal.bed | intersectBed -wa -wb -loj -a /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.narrowPeak.gz -b stdin | sort -k15,15n | sort -u -k1,1 -k2,2n -k3,3n -k10,10n | cut -f1,2,3,10,7,15 > /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W_signalVsCoreNewTFModiscoqVal.bed
awk 'BEGIN{OFS="\t"} $4=="Upstream"' /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.FIMOResultsNewTFModiscoMotifsAllHits/fimoqVal.bed | intersectBed -wa -wb -loj -a /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.narrowPeak.gz -b stdin | sort -k15,15n | sort -u -k1,1 -k2,2n -k3,3n -k10,10n | cut -f1,2,3,10,7,15 > /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W_signalVsUpstreamNewTFModiscoqVal.bed
awk 'BEGIN{OFS="\t"} $4=="Downstream"' /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.FIMOResultsNewTFModiscoMotifsAllHits/fimoqVal.bed | intersectBed -wa -wb -loj -a /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.narrowPeak.gz -b stdin | sort -k15,15n | sort -u -k1,1 -k2,2n -k3,3n -k10,10n | cut -f1,2,3,10,7,15 > /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W_signalVsDownstreamNewTFModiscoqVal.bed
awk 'BEGIN{OFS="\t"} $4=="UpstreamCore"' /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.FIMOResultsNewTFModiscoMotifsAllHits/fimoqVal.bed | intersectBed -wa -wb -loj -a /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.narrowPeak.gz -b stdin | sort -k15,15n | sort -u -k1,1 -k2,2n -k3,3n -k10,10n | cut -f1,2,3,10,7,15 > /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W_signalVsUpstreamCoreNewTFModiscoqVal.bed
awk 'BEGIN{OFS="\t"} $4=="CoreDownstream"' /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.FIMOResultsNewTFModiscoMotifsAllHits/fimoqVal.bed | intersectBed -wa -wb -loj -a /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.narrowPeak.gz -b stdin | sort -k15,15n | sort -u -k1,1 -k2,2n -k3,3n -k10,10n | cut -f1,2,3,10,7,15 > /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W_signalVsCoreDownstreamNewTFModiscoqVal.bed
awk 'BEGIN{OFS="\t"} $4=="UpstreamCoreDownstream"' /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.FIMOResultsNewTFModiscoMotifsAllHits/fimoqVal.bed | intersectBed -wa -wb -loj -a /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W.narrowPeak.gz -b stdin | sort -k15,15n | sort -u -k1,1 -k2,2n -k3,3n -k10,10n | cut -f1,2,3,10,7,15 > /srv/scratch/imk1/TFBindingPredictionProject/MouseCohesinData/Ctcf_Heart_Ren_8W_signalVsUpstreamCoreDownstreamNewTFModiscoqVal.bed
